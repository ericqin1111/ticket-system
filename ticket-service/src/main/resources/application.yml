server:
  port: 8121
spring:
  application:
    name: ticket-service
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
  data:
    redis:
      host: localhost
      port: 6379
      password: 123456
      database: 0
  # --- Kafka配置 ---
  kafka:
    bootstrap-servers: localhost:29092
    consumer:
      group-id: ticket_update_group # 定义消费者组
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
  # --- 数据库配置 ---
  datasource:
    url: jdbc:mysql://localhost:3306/ticket_system?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai
    username: root
    password: root
# MyBatis-Plus 配置
mybatis-plus:
  mapper-locations: classpath:/mapper/*.xml
  configuration:
    map-underscore-to-camel-case: true
redisson:
  single-server-config:
    address: "redis://127.0.0.1:6379"
    # 如果有密码
    password: 123456
    database: 0


management:
  endpoints:
    web:
      exposure:
        include:
          - health
          - info
          - prometheus
          - metrics
  endpoint:
    prometheus:
      enabled: true
  tracing:
    sampling:
      probability: 1.0 # 1.0 表示100%采样，生产环境可适当调低，如0.1
    enabled: false

# 缓存配置（多级缓存）
cache:
  key:
    tier-version: 1
  local:
    enabled: true
    maximum-size: 50000
    expire-after-write-ms: 1200000   # 20 分钟
    negative-ttl-ms: 30000
  redis:
    ttl-ms: 3600000                 # 1 小时
    negative-ttl-ms: 30000
    hot-key-ttl-ms: 10800000        # 3 小时
    compress: false
  breaker:
    degrade-on-error: true
    use-redis-lock-for-penalty: false
